---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

// 1. Generate a path for every post in your folder
export async function getStaticPaths() {
  const allPosts = await getCollection("posts");
  return allPosts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

// 2. Get the specific post from the props
const { post } = Astro.props;

// 3. This function converts the Markdown body into HTML
const { Content } = await post.render();
---

<Layout title={`${post.data.title} - St. Nicholas Orthodox Church`}>
  <link rel="stylesheet" href="/post.css" />

    <div class="content">
      <div class="post-hero">
        <img
          src={post.data.image?.replace(/^\/public/, '') || 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="1200" height="500"%3E%3Crect width="1200" height="500" fill="%23e0e0e0"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="sans-serif" font-size="32" fill="%23666"%3ENo Image%3C/text%3E%3C/svg%3E'}
          alt={post.data.title}
          class="post-hero-image"
        />
      </div>
      <nav class="post-navigation">
        <a href="/posts">‚Üê Back to Blog</a>
      </nav>

      <header class="post-header">
        <h1>{post.data.title}</h1>

        {
          post.data.date && (
            <p class="post-meta">
              Published on: {post.data.date.toDateString()}
            </p>
          )
        }
      </header>

      <article class="post-content">
        <Content />
      </article>
    </div>

</Layout>
