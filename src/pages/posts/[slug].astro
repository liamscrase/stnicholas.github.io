---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// 1. Generate a path for every post in your folder
export async function getStaticPaths() {
  const allPosts = await getCollection('posts');
  return allPosts.map(post => ({
    params: { slug: post.slug }, 
    props: { post },
  }));
}

// 2. Get the specific post from the props
const { post } = Astro.props;

// 3. This function converts the Markdown body into HTML
const { Content } = await post.render();
---

<Layout title={`${post.data.title} - St. Nicholas Orthodox Church`}>
  <link rel="stylesheet" href="/post.css" />
  
  <div class="content">
    <nav class="post-navigation">
      <a href="/posts">‚Üê Back to Blog</a>
    </nav>

    <header class="post-header">
      <h1>{post.data.title}</h1>
      
      {post.data.date && (
        <p class="post-meta">Published on: {post.data.date.toDateString()}</p>
      )}
    </header>

    <article class="post-content">
      <Content />
    </article>
  </div>
</Layout>